<h3 id="api-vis">Visualisation</h3>

<p>In the <a href="#js-examples">example above</a> we have shown how to use the
    <a href="https://github.com/dataseed/dataseed-visualisation">Dataseed
        Javascript Library</a>
    to embed a visualisation within an existing Javascript application.
    Starting from that example, the following shows how to define a
    visualisation directly in the context of the consumer application instead of
    fetching it from Dataseed.
</p>

<pre><code class="html prettyprint">&lt;!doctype html&gt;
&lt;html dir="ltr" lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /&gt;
    &lt;title&gt;Dataseed Interactive Data Visualization&lt;/title&gt;
    &lt;meta name="viewport" content="width=device-width" /&gt;
    &lt;!--[if lt IE 9]&gt;
      &lt;script src="http://html5shim.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;
    &lt;![endif]--&gt;
    &lt;link href="src/less/dataseed.less" rel="stylesheet/less" type="text/css" /&gt;
    &lt;script src="src/components/less/dist/less-1.4.0.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;button id="start"&gt;Show me the visualisation!&lt;/button&gt;
    &lt;div id="vis"&gt;&lt;/div&gt;
    &lt;script src="src/components/requirejs/require.js" data-main="src/js/config"&gt;&lt;/script&gt;
    &lt;script&gt;

        require.config({
            "config": {
                "models/datasetSingleton": {
                    "DATASET": {
                        "id": "mortality",
                        "label": "Mortality",
                        "public": true,
                        "imports": [],
                        "fields": [
                            {
                                "id": "year",
                                "label": "Year",
                                "description": null,
                                "aggregations": [],
                                "charts": [{"type": "bar"}, {"type": "bubble"}, {"type": "table"}]
                            },
                            {
                                "id": "gender",
                                "label": "Gender",
                                "description": null,
                                "aggregations": [],
                                "charts": [{"type": "bar"}, {"type": "bubble"}, {"type": "table"}]
                            },
                            {
                                "id": "value",
                                "label": "Value",
                                "description": null,
                                "aggregations": [{"type": "sum"}, {"type": "mean"}, {"type": "min"}, {"type": "max"}],
                                "charts": []
                            }

                        ],
                        "visualisations": [
                            {
                                "id": "1",
                                "label": "Mortality in England and Wales",
                                "description": "Explore and compare the number of deaths by disease, sex, area and year",
                                "provenance": "Mortality statistics are based on details collected when deaths are certified and registered",
                                "public": true,
                                "elements": [
                                    {
                                        "id": "year",
                                        "label": "Year",
                                        "measure_label": "Number of deaths",
                                        "type": "bar",
                                        "aggregation": "sum",
                                        "measure": {"id": "value"},
                                        "dimensions": [{"field": {"id": "year", "type": "string"}}],
                                        "width": 1,
                                        "weight": 2,
                                        "display": true
                                    },
                                    {
                                        "id": "gender",
                                        "label": "Gender",
                                        "measure_label": "Number of deaths",
                                        "type": "bar",
                                        "aggregation": "sum",
                                        "measure": {"id": "value"},
                                        "dimensions": [{"field": {"id": "gender", "type": "string"}}],
                                        "width": 1,
                                        "weight": 5,
                                        "display": true
                                    }
                                ],
                                "styles": []
                            }
                        ],
                        "modified": "2013-09-06T10:33:39.789859",
                        "created": "2013-09-06T10:33:39.789859"
                    } // end "DATASET"
                }
            } // end "config"
        });

        $(document).ready(function() {
            $('#start').click(function() {
                require(['./dataseed/views/dataset', 'app'], function(DatasetEmbedView) {
                    new DatasetEmbedView({
                        'el': $('#vis'),
                        'id': 'mortality',
                        'visualisation_id': '1'
                    });
                });
            });
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

<h4>Optional attributes</h4>
<p>This section shows all the optional Dataset model attributes and how to
    use them in a visualisation defined in the context of a consumer
    application.</p>
<ul>
    <li>
        <strong>Dataset</strong>
        <ul>
            <li>
                <h5 id="default-cut">cut</h5>
                    <p>The <em>cut</em> dataset attribute allow to define a cut on the dataset
                        dimensions that has to be applied by default when the visualisation is
                        rendered.</p>

<pre><code class="html prettyprint">&lt;script&gt;
    require.config({
        "config": {
            "models/datasetSingleton": {
                "DATASET": {
                    "id": "mortality",
                    "label": "Mortality",
                    "fields": [
                        {
                            "id": "gender",
                            "label": "Gender",
                            "description": null,
                            "aggregations": [],
                            "charts": [{"type": "bar"}, {"type": "bubble"}, {"type": "table"}]
                        },
                        // Other Dataset fields here ...

                    ],
                    "cut": {
                        "gender": "F",
                    },
                    // Other Dataset attributes here ...
                }
            }
        }
    });
&lt;/script&gt;
</code></pre>
            </li>
        </ul>
    </li>
    <li>
        <strong>Dataset Fields</strong>
        <ul>
            <li>
                <h5>update_dimension</h5>

                <p>Related to a dataset's field, this attribute is set to
                    <em>true</em> if the values for the dimensions related to
                    the field need to be fetched every time a cut is applied to
                    the dataset. Otherwise dimension's values are fetched only
                    once, i.e. when DatasetEmbedView() is instantiated.</p>

                <p><em>Default value</em>: False</p>

<pre><code class="html prettyprint">&lt;script&gt;
    require.config({
        "config": {
            "models/datasetSingleton": {
                "DATASET": {
                    "id": "mortality",
                    "label": "Mortality",
                    "fields": [
                        {
                            "id": "year",
                            "label": "Year",
                            "description": null,
                            "aggregations": [],
                            "charts": [{"type": "bar"}, {"type": "bubble"}, {"type": "table"}],
                            "update_dimension": true
                        },
                        // Other Dataset fields here ...

                    ],
                    // Other Dataset attributes here ...
                }
            }
        }
    });
&lt;/script&gt;
</code></pre>
            </li>
        </ul>
    </li>
    <li>
        <strong>Visualisation Elements</strong>
        <ul>
            <li>
                <strong>Charts</strong>
                <ul>
                    <li>
                        <h5>interactive</h5>

                        <p>By default a click on a chart element feature
                            (bar/point/etc.) makes a new cut to be added to the
                            dataset. Set this attribute to <em>false</em> in
                            order to make the chart not reacting on the feature
                            click event.</p>

                        <p><em>Default value</em>: true</p>

<pre><code class="html prettyprint">&lt;script&gt;
    require.config({
        "config": {
            "models/datasetSingleton": {
                "DATASET": {
                    // Dataset attributes here (e.g. fields) ...
                    "visualisations": [
                        {
                            "id": "1",
                            "label": "Mortality in England and Wales",
                            // Other visualisation attributes here ...
                            "public": true,
                            "elements": [
                                {
                                    "id": "year",
                                    "label": "Year",
                                    "measure_label": "Number of deaths",
                                    "type": "bar",
                                    "interactive": false,
                                    // Other element attribute here ...
                                },
                                // Other elements here ...
                            ],

                        }
                    ]
                    // Other dataset attributes here ...
                }
            }
        }
    });
&lt;/script&gt;
</code></pre>
                    </li>
                </ul>
            </li>
            <li>
                <strong>Filters</strong>
                <ul>
                    <li>
                        <h5>required</h5>

                        <p>At the moment this attribute is taken into account
                            only by the Filter Form element. It is related to an
                            element's dimension: if it is set to
                            <strong>true</strong> the
                            element won't let the user to unset the cut on the
                            dimension the attribute refers to. This also means
                            that a <a href="#default-cut">default cut</a> needs
                            to be defined for the required element dimensions.
                        </p>

                        <p><em>Default value</em>: false</p>

<pre><code class="html prettyprint">&lt;script&gt;
    require.config({
        "config": {
            "models/datasetSingleton": {
                "DATASET": {
                    // Dataset attributes here (e.g. fields) ...
                    "visualisations": [
                        {
                            "id": "1",
                            "label": "Mortality in England and Wales",
                            "public": true,
                            // Other visualisation attributes here ...
                            "elements": [
                                {
                                    "id": "year",
                                    "label": "Year",
                                    "measure_label": "Number of deaths",
                                    "type": "filterForm",
                                    "required": true,
                                    // Other element attribute here ...
                                },
                                // Other elements here ...
                            ],

                        }
                    ]
                    // Other dataset attributes here ...
                }
            }
        }
    });
&lt;/script&gt;
</code></pre>
                    </li>
                    <li>
                        <h5>sort</h5>

                        <p>Defines the order in which the filter options have to
                            be displayed. The value for this attribute is an
                            object in the
                            format <em>{"[attribute]": "[direction]"}</em>
                            where:
                        <ul>
                            <li>
                                <em>[attribute]</em> is either "total" or
                                "label"
                            </li>
                            <li>
                                <em>[direction]</em> is either "asc" or "desc"
                            </li>
                        </ul>
                        </p>

                        <p><em>Default value</em>: {"total": "desc"}</p>

<pre><code class="html prettyprint">&lt;script&gt;
    require.config({
        "config": {
            "models/datasetSingleton": {
                "DATASET": {
                    // Dataset attributes here (e.g. fields) ...
                    "visualisations": [
                        {
                            "id": "1",
                            "label": "Mortality in England and Wales",
                            "public": true,
                            // Other visualisation attributes here ...
                            "elements": [
                                {
                                    "id": "year",
                                    "label": "Year",
                                    "measure_label": "Number of deaths",
                                    "type": "filterForm",
                                    "sort": {
                                        "label": "asc"
                                    },
                                    // Other element attribute here ...
                                },
                                // Other elements here ...
                            ],

                        }
                    ]
                    // Other dataset attributes here ...
                }
            }
        }
    });
&lt;/script&gt;
</code></pre>
                    </li>
                </ul>
            </li>
        </ul>
    </li>
</ul>



